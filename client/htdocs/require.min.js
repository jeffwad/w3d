(function(a){typeof StopIteration==="undefined"&&(StopIteration=new Error);var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=!1;b=function(){var a=function(){};return function(b,c){var d,e,f;a.prototype=b,a.prototype.callSuper=function(){var a=Array.prototype.shift.call(arguments);return a.callee.callSuper.apply(this,arguments)},d=new a;if(c)for(f in c)e=d[f],d[f]=c[f],typeof e==="function"&&(d[f].callSuper=e);(c&&!c.skipInit||typeof c==="undefined")&&typeof d.__init__==="function"&&d.__init__.call(d),delete d.skipInit;return d}}(),c=function(a,b){var c;for(c in b)a[c]=b[c]},d=function(a,b){var c=!1,d,e,f;if(typeof a.next==="function")c=a;else if(typeof a.__iterator__==="function")c=a.__iterator__();else if(a.length)d=0,c={next:function(){if(typeof a[d]!=="undefined")return[a[d],d++];throw StopIteration}};else if(b){e=[],d=0,f;for(f in a)e.push(f);c={next:function(){var b;f=e[d++],b=a[f];if(typeof b!=="undefined")return[b,f];throw StopIteration}}}return c},e=function(a,b){var c,e,f,g;try{if(typeof a.length==="number")for(c=0,e=a.length;c<e;c++)b(a[c],c);else{g=d(a);if(g){c=0;while(!0)f=g.next(),b(f[0],f[1])}else for(c in a)a.hasOwnProperty(c)&&b(a[c],c)}}catch(h){if(h!==StopIteration)throw h}},f=function(a,b,c){typeof a.forEach==="function"?a.forEach(b,c):e(a,function(a,d){b.call(c,a,d)})},g=function(a,b,c){if(typeof a.filter==="function")return a.filter(b,c);var d=a.length?[]:{};e(a,function(e,f){b.call(c,e,f)&&(a.length?d.push(e):d[f]=e)});return d},h=function(a,b,c){if(typeof a.map==="function")return a.map(b,c);var d=a.length?[]:{};e(a,function(e,f){var g=b.call(c,e,f);a.length?d.push(g):d[f]=g});return d},i=function(a,b,c){if(typeof a.some==="function")return a.some(b,c);var d=!1;e(a,function(a,e){if(d=b.call(c,a,e))throw StopIteration});return d},j=function(a,b,c){if(typeof a.every==="function")return a.every(b,c);var d=!0;e(a,function(a,e){if(!(d=b.call(c,a,e)))throw StopIteration});return d},k=function(a,b){if(typeof a.indexOf==="function")return a.indexOf(b);var c=-1;e(a,function(a,d){if(a===b){c=d;throw StopIteration}});return c},l=function(a,b){if(typeof a.lastIndexOf==="function")return a.lastIndexOf(b);var c=-1;e(a,function(a,d){a===b&&(c=d)});return c},m=function(a){var b=[];e(a,function(a,c){b.push(a)});return b},n=function(a,b,c,d){e(b,function(b,e){a=c.call(d,a,b,e)});return a},o=function(a,b){return n(b||0,a,function(a,b){return a+b})},p=function(a,b){return h(a,function(a){return a[b]})},q=function(){if(arguments.length===1)return d(arguments[0]);var a=h(arguments,d);return{next:function(){try{return a[0].next()}catch(b){if(b!==StopIteration)throw b;if(a.length===1)throw StopIteration;a.shift();return a[0].next()}}}},self.debug&&(P=!0),z=function(){var a,c=[],d={},e=0,g=!1,h={constructor:"promise",fire:function(b){a!==-1&&(b&&!g&&(g=b),a=1,f(c,function(a){var b=1,c=a.parent===-1?g:d[[a.pos,a.parent].join("")];while(a.stack.length>0)(function(){var e=a.stack.shift()[c instanceof Error?1:0];!e||(d[[b++,a.id].join("")]=e(c))})()}))},cancel:function(){a=-1},then:function(d,f){var g;this.stack.push([d,f]),g=b(h,{pos:this.stack.length,id:e++,parent:this.id,stack:[]}),c.push(g),a===1&&i.fire();return g},inspect:function(){console.dir(d)}},i=b(h,{pos:1,id:e++,parent:-1,stack:[]});c[i.id]=i;return i},A=function(){var a,b=0,c=arguments.length,d,e=arguments;a=z(),d=function(){e[b++].then(function(e){b<c?d():a.fire(e);return e},function(a){return a})},d();return a},s=function(b,c,d,e,g,h,i){var j=new XMLHttpRequest,k,l,m={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, application/json, application/javascript"};j.open(b,c,!0),f(g,function(a,b){m[b]=a}),f(m,function(a,b){j.setRequestHeader(b,a)}),k=z(),j.onreadystatechange=function(){j.readyState===4&&(clearTimeout(l),r.test(j.status)?k.fire(function(){switch(d){case"xml":return j.responseXML?j.responseXML.documentElement:j.documentElement;case"json":return a(j.responseText);default:return j.responseText}}()):k.fire(new Error(j.status)))},j.send(i||null),l=setTimeout(function(){j.abort(),h>0?(console.warn(h,": ",c),u(c,d,{timeout:e,headers:g,repeat:h-1,data:i}).then(function(a){return k.fire(a)},function(){return k.fire(new Error(j.status))})):k.fire(new Error("Timeout exceeded"))},e*1e3);return k},r=/(200|201|204|304)/,t=function(a,b){typeof a!=="string"&&(a=n([],a,function(a,b,c){a[a.length]=c+"="+b;return a}).join("&"));return b?a:encodeURIComponent(a)},u=function(a,b,c){c=c||{},c.data&&(a+=(a.indexOf("?")!==-1?"&":"?")+t(c.data,!0));var d=s("GET",a,b,c.timeout||5,c.headers||{},c.repeat||0);d.then(c.success||!1,c.error||!1);return d},v=function(a,b,c){c=c||{},c.headers=c.headers||{},c.headers["Content-type"]="application/"+b;var d=s("POST",a,b,c.timeout||20,c.headers,c.repeat||0,c.data?t(c.data,!0):"");d.then(c.success||!1,c.error||!1);return d},w=function(a,b,c){c=c||{},c.headers=c.headers||{},c.headers["Content-type"]="application/"+b;var d=s("PUT",a,b,c.timeout||20,c.headers,c.repeat||0,c.data?t(c.data,!0):"");d.then(c.success||!1,c.error||!1);return d},x=function(a,b,c){c=c||{};var d=s("DELETE",a,b,c.timeout||5,c.headers||{},c.repeat||0);d.then(c.success||!1,c.error||!1);return d},y=function(){var a=function(a,b){a="~"+a+"~";return"~m~"+(a+b).length+"~m~"+a+b};return function(b){var c,d,e,f;c=J(),d=L(),d.on("sendMessage",function(b){f.send(a("j",JSON.stringify(b)))});try{f=new WebSocket(b),f.onopen=function(){d.fire("socketConnected",{id:c})},f.onmessage=function(b){var c;switch(!0){case/~j~/.test(b.data):c=JSON.parse(b.data.split("~j~")[1]),d.fire(c.type,c.data);break;case/~h~/.test(b.data):f.send(a("h",b.data.split("~h~")[1]))}},f.onclose=function(a){d.fire("socketClosed",{id:c})},f.onerror=function(a){console.log(a)}}catch(g){console.log(g)}return{on:function(a,b){return d.on(a,b)},fire:function(a,b){d.fire("sendMessage",{type:a,id:c,data:b})},close:function(){f.close()}}}}(),B=function(){var a=arguments[0],b=arguments[1],c=[],d,e;for(d=1,e=arguments.length;d<e;d++)c[d]=arguments[d];return function(){return a.apply(b,c)}},C=function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);return function(){var c,d=b.length,e=0,f=arguments.length;for(c=0;c<d&&e<f;c++)typeof b[c]==="undefined"&&(b[c]=arguments[e++]);return a.apply(!1,b)}},D=function(){var a=/^\s*|\s*$/g;return function(b){return b.replace(a,"")}}(),E=function(){var a=/(-([a-z]))/g;return function(b){return b.replace(a,function(a,b,c){return c.toUpperCase()})}}(),F=function(){var a=/([A-Z])/g;return function(b){return b.replace(a,function(a,b){return"-"+b.toLowerCase()})}}(),G=function(){var a=/^([a-zA-Z])([a-zA-Z]+)/;return function(b){return b.replace(a,function(a,b,c){return b.toUpperCase()+c.toLowerCase()})}}(),H=function(){var a=/{([^{}]*)}/g;return function(b,c){return b.replace(a,function(a,b){var d=c[b];return typeof d==="string"||typeof d==="number"?d:b})}}(),I=function(){return Math.floor(Math.random()*1e12)},J=function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return function(){var b,c,d=[];d[8]=d[13]=d[18]=d[23]="-",d[14]="4";for(b=0;b<36;b++)d[b]||(c=0|Math.random()*16,d[b]=a[b==19?c&3|8:c]);return d.join("")}}(),K=function(){var a,c;a={start:function(){this.isActive||(this.obj[this.type].stack[this.id]=this.func,this.isActive=!0)},stop:function(){this.isActive===!0&&(delete this.obj[this.type].stack[this.id],this.isActive=!1)}},c=function(a,b){f(a,function(a){a(b)})};return function(d,e,f){var g,h,i;g=J(),d[e]&&!d[e].stack&&(h=d[e],d[e]=function(){var a={type:e,target:this};a.returnValue=h.apply(this,arguments),c(d[e].stack,a);return a.returnValue},d[e].stack={}),i=b(a,{obj:d,type:e,func:f,id:g}),i.start();return i}}(),L=function(){var a,b,c;c={},b=function(a,b){if(P)try{console.log(a,b||"")}catch(d){}typeof c[a]==="function"&&c[a](b)},a={fire:function(a,c){b(a,c)},addListener:function(a,b){c[a]||(c[a]=function(a){return a});return K(c,a,function(a){b(a.returnValue)})},once:function(a,b){c[a]||(c[a]=function(a){return a});return K(c,a,function(a){b(a.returnValue)})}},a.on=a.addListener;return a},O=function(){var a,b,c;c=[],b=L(),a={fire:function(a,d){b.fire(a,d),f(c,function(b){b.postMessage({type:a,data:d})})},receive:function(a){b.fire(a.type,a.data)},addListener:function(a,c){b.addListener(a,c)},addWorker:function(b){b.onmessage=function(b){a.receive(b.data)},b.onerror=function(b){a.receive({type:"workerError",data:{message:b.message,filename:b.filename,lineno:b.lineno}})},c.push(b)}},a.on=a.addListener;return a}(),f(["log","warn","error"],function(a){O.addListener("console_"+a,function(b){console[a].apply(console,b.args)})}),function(){var a={},b={},c={},d,e,h,i,j,k;d=function(a){return c[a].def},typeof importScripts==="function"?e=function(a){if(c[a])return d(a);self.debug||(a+=".min"),importScripts(a+".js")}:(k=document.getElementsByTagName("head")[0],e=function(b){if(c[b])return d(b);a[b]=!0;var e=document.createElement("script");e.id=b,self.debug||(b+=".min"),e.src=b+".js",k.appendChild(e)}),h=function(c){a[c]=!0,u(c,"txt",{headers:{"Cache-Control":"no-cache, must-revalidate, no-store",Pragma:"no-cache"}}).then(function(d){j(c,d),delete a[c],f(b,function(a,b){i(b,a.dependencies,a.def)})})},i=function(k,l,m){var n,o;try{delete a[k],arguments.length===2&&(m=l,l=[]),l=g(l,function(d){if(!c[d]){if(a[d])return!0;if(b[d])return!0;/\.\w{2,3}$/.test(d)?h(d):e(d);return!0}return!1}),l.length===0?(n={},o={path:k},m(d,n,o),j(k,n,o),delete b[k],f(b,function(a,b){i(b,a.dependencies,a.def)}),O.fire("moduleInitialised",{moduleName:k})):b[k]={dependencies:l,def:m}}catch(p){console.dir(p)}},j=function(a,b,d){d=d||{},d.id=d.id||a,c[a]={module:d,def:b}},self.require=e,self.define=i,self.require.inspect=function(a){console.dir(a?c[a]:c)}}(),N=function(a,b,c){var d,e,f,g;if(Worker){d=z(),d.then(b||!1,c||!1),g=new Worker("/worker.js"),g.onmessage=function(b){f=b.data.guid,this.postMessage({type:"loadInitialModule",module:a}),O.addWorker(g)},e=O.addListener("initialModuleLoaded",function(b){b.guid===f&&(e.stop(),e=null,d.fire(a))});return d}return M(a,b,c)},M=function(a,b,c){var d,e;d=z(),d.then(b||!1,c||!1),e=O.addListener("moduleInitialised",function(b){b.moduleName===a&&(e.stop(),e=null,d.fire(a))}),require(a);return d},define("sys",function(a,b){b.addWorker=O.addWorker,b.fire=O.fire,b.addListener=O.addListener,b.on=O.on,b.once=O.once}),define("object",function(a,d){d.create=b,d.extend=c}),define("iter",function(a,b){b.forEach=f,b.filter=g,b.map=h,b.some=i,b.every=j,b.indexOf=k,b.lastIndexOf=l,b.toArray=m,b.reduce=n,b.sum=o,b.pluck=p,b.chain=q,b.iterator=d}),define("events",function(a,b){b.observe=K,b.eventMachine=L}),define("async",function(a,b){b.deferred=z,b.when=A}),define("net",function(a,b){b.get=u,b.post=v,b.put=w,b.del=x,b.socket=y}),define("func",function(a,b){b.bind=B,b.partial=C}),define("string",function(a,b){b.trim=D,b.camelCase=E,b.hyphenate=F,b.capitalise=G,b.interpolate=H}),define("gen",function(a,b){b.randomNumber=I,b.generateGuid=J}),define("module",function(a,b){b.spawn=N,b.load=M})})(function(string){try{return eval("("+string+")")}catch(e){console.error(e.message);return!1}})