define("/lib/webgl/core/main",["object","iter","/lib/webgl/core/glMatrix","/lib/webgl/core/modelView","/lib/webgl/core/camera","/lib/webgl/shaders/vertex.gl","/lib/webgl/shaders/fragment.gl"],function(a,b,c){function F(a){if(!!z){var b=a.clientX,c=a.clientY,d=b-A,e=m.create();m.identity(e),m.rotate(e,o(d/10),[0,1,0]);var f=c-B;m.rotate(e,o(f/10),[1,0,0]),m.multiply(e,C,C),A=b,B=c}}function E(a){z=!1}function D(a){z=!0,A=a.clientX,B=a.clientY}function y(){try{p.uniformMatrix4fv(r.uPMatrix,!1,new Float32Array(h.matrix)),p.uniformMatrix4fv(r.uMVMatrix,!1,new Float32Array(g.matrix))}catch(a){alert(a)}}var d=a("object"),e=a("iter").some,f=a("/lib/webgl/core/glMatrix"),g=a("/lib/webgl/core/modelView"),h=a("/lib/webgl/core/camera"),i=a("/lib/webgl/shaders/vertex.gl"),j=a("/lib/webgl/shaders/fragment.gl"),k=f.vec3,m=f.mat4,n=f.quat4,o=f.degToRad,p,q,r,s,t,u,v,w,x,y;p=!1,s={},r={},t=[],v=function(a,b){var c;c=p.createShader(p[a.toUpperCase()+"_SHADER"]),p.shaderSource(c,b),p.compileShader(c);if(!p.getShaderParameter(c,p.COMPILE_STATUS))throw new Error("Could not create shader: "+a+": "+p.getShaderInfoLog(c));return c},w=function(){q=p.createProgram(),p.attachShader(q,v("vertex",i)),p.attachShader(q,v("fragment",j)),p.linkProgram(q);if(!p.getProgramParameter(q,p.LINK_STATUS))throw new Error("Could not initialise shaders");p.useProgram(q),s.aVertexPosition=p.getAttribLocation(q,"aVertexPosition"),p.enableVertexAttribArray(s.aVertexPosition),s.aVertexColour=p.getAttribLocation(q,"aVertexColour"),p.enableVertexAttribArray(s.aVertexColour),r.uPMatrix=p.getUniformLocation(q,"uPMatrix"),r.uMVMatrix=p.getUniformLocation(q,"uMVMatrix")},x=function(a){if(!e(["webgl","experimental-webgl","webkit-3d","moz-webgl"],function(b){try{p=a.getContext(b),p.viewportWidth=parseFloat(a.style.width,10),p.viewportHeight=parseFloat(a.style.height,10),a.addEventListener("webglcontextcreationerror",function(a){console.error(a.statusMessage)},!1)}catch(c){}if(p)return!0;return!1}))throw new Error("Could not initialise WebGL, sorry :-(")};var z=!1,A=null,B=null,C=m.create();m.identity(C),render=function(){requestAnimFrame(render);var a;p.viewport(0,0,p.viewportWidth,p.viewportHeight),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),h.identity(),h.rotateY(-30),h.translate([-30,-8,-30]),m.multiply(g.matrix,C);for(a=0,l=t.length;a<l;a++)t[a].render()},b.line={__init__:function(){this.type=p.LINES,this.indices=[0,1],this.vBuffer=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,this.vBuffer),p.bufferData(p.ARRAY_BUFFER,new Float32Array(this.vertices),p.STATIC_DRAW),this.cBuffer=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,this.cBuffer),p.bufferData(p.ARRAY_BUFFER,new Float32Array(this.colours),p.STATIC_DRAW),this.iBuffer=p.createBuffer(),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,this.iBuffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),p.STATIC_DRAW),t.push(this)},render:function(){g.push(),m.translate(g.matrix,this.position),p.bindBuffer(p.ARRAY_BUFFER,this.vBuffer),p.vertexAttribPointer(s.aVertexPosition,this.size,p.FLOAT,!1,0,0),p.bindBuffer(p.ARRAY_BUFFER,this.cBuffer),p.vertexAttribPointer(s.aVertexColour,4,p.FLOAT,!1,0,0),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,this.iBuffer),p.lineWidth(1),y(),p.drawElements(this.type,this.indices.length,p.UNSIGNED_SHORT,0),g.pop()}},b.mesh={__init__:function(){this.type=p.TRIANGLES,this.vBuffer=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,this.vBuffer),p.bufferData(p.ARRAY_BUFFER,new Float32Array(this.vertices),p.STATIC_DRAW),this.cBuffer=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,this.cBuffer),p.bufferData(p.ARRAY_BUFFER,new Float32Array(this.colours),p.STATIC_DRAW),this.iBuffer=p.createBuffer(),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,this.iBuffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),p.STATIC_DRAW),t.push(this)},render:function(){g.push(),m.translate(g.matrix,this.position),p.bindBuffer(p.ARRAY_BUFFER,this.vBuffer),p.vertexAttribPointer(s.aVertexPosition,this.size,p.FLOAT,!1,0,0),p.bindBuffer(p.ARRAY_BUFFER,this.cBuffer),p.vertexAttribPointer(s.aVertexColour,4,p.FLOAT,!1,0,0),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,this.iBuffer),y(),p.drawElements(this.type,this.indices.length,p.UNSIGNED_SHORT,0),g.pop()}},b.init=function(a){x(a),w(),p.clearColor(0,0,0,1),p.clearDepth(1),p.enable(p.DEPTH_TEST),p.depthFunc(p.LEQUAL),h.init(p.viewportWidth,p.viewportHeight),d.create(b.line,{position:[0,0,0],vertices:[-1e6,0,0,1e6,0,0],colours:[1,0,0,1,1,0,0,1],size:3,items:2}),d.create(b.line,{position:[0,0,0],vertices:[0,-1e6,0,0,1e6,0],colours:[0,0,1,1,0,0,1,1],size:3,items:2}),d.create(b.line,{position:[0,0,0],vertices:[0,0,1e6,0,0,-1e6],colours:[0,1,0,1,0,1,0,1],size:3,items:2}),a.onmousedown=D,document.onmouseup=E,document.onmousemove=F,render()},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1e3/60)}}()})