define("/lib/webgl/core/main",["object","iter","/lib/webgl/core/glMatrix","/lib/webgl/core/modelView","/lib/webgl/core/camera","/lib/webgl/core/line","/lib/webgl/core/mesh"],function(a,b,c){var d=a("object"),e=a("iter").some,f=a("/lib/webgl/core/glMatrix"),g=a("/lib/webgl/core/modelView"),h=a("/lib/webgl/core/camera"),i=f.vec3,j=f.mat4,k=f.quat4,m=f.degToRad,n,o,p,q,r,s,t,u;n=!1,q={},p={},r=[],s=function(a,b){var c;c=n.createShader(n[a.toUpperCase()+"_SHADER"]),n.shaderSource(c,b),n.compileShader(c);if(!n.getShaderParameter(c,n.COMPILE_STATUS))throw new Error("Could not create shader: "+a+": "+n.getShaderInfoLog(c));return c},t=function(){try{n.uniformMatrix4fv(p.uPMatrix,!1,new Float32Array(h.perspective)),n.uniformMatrix4fv(p.uMVMatrix,!1,new Float32Array(g.matrix))}catch(a){alert(a)}},u=function(){requestAnimFrame(u);var a;n.viewport(0,0,n.viewportWidth,n.viewportHeight),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),h.identity(),h.rotateY(-30),h.rotateX(-1),h.translate([-30,-8,-30]),j.multiply(g.matrix,h.rotation);for(a=0,l=r.length;a<l;a++)r[a].render()},b.context=function(a){var b=a.width=parseFloat(a.style.width,10),c=a.height=parseFloat(a.style.height,10);if(!e(["webgl","experimental-webgl","webkit-3d","moz-webgl"],function(d){try{n=a.getContext(d),n.viewportWidth=b,n.viewportHeight=c,a.addEventListener("webglcontextcreationerror",function(a){console.error(a.statusMessage)},!1)}catch(e){}if(n)return!0;return!1}))throw new Error("Could not initialise WebGL, sorry :-(")},b.init=function(){n.clearColor(0,0,0,1),n.clearDepth(1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),h.init(n.viewportWidth,n.viewportHeight)},b.program=function(a,b){o=n.createProgram(),n.attachShader(o,s("vertex",a)),n.attachShader(o,s("fragment",b)),n.linkProgram(o);if(!n.getProgramParameter(o,n.LINK_STATUS))throw new Error("Could not initialise shaders");n.useProgram(o),q.aVertexPosition=n.getAttribLocation(o,"aVertexPosition"),n.enableVertexAttribArray(q.aVertexPosition),q.aVertexColour=n.getAttribLocation(o,"aVertexColour"),n.enableVertexAttribArray(q.aVertexColour),p.uPMatrix=n.getUniformLocation(o,"uPMatrix"),p.uMVMatrix=n.getUniformLocation(o,"uMVMatrix")},b.run=function(){u()},b.camera=h,b.line={__init__:function(){this.type=n.LINES,this.indices=[0,1],this.vBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this.vertices),n.STATIC_DRAW),this.cBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.cBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this.colours),n.STATIC_DRAW),this.iBuffer=n.createBuffer(),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.iBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),n.STATIC_DRAW),r.push(this)},render:function(){g.push(),j.translate(g.matrix,this.position),n.bindBuffer(n.ARRAY_BUFFER,this.vBuffer),n.vertexAttribPointer(q.aVertexPosition,this.size,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this.cBuffer),n.vertexAttribPointer(q.aVertexColour,4,n.FLOAT,!1,0,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.iBuffer),n.lineWidth(1),t(),n.drawElements(this.type,this.indices.length,n.UNSIGNED_SHORT,0),g.pop()}},b.mesh={__init__:function(){this.type=n.TRIANGLES,this.vBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this.vertices),n.STATIC_DRAW),this.cBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.cBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this.colours),n.STATIC_DRAW),this.iBuffer=n.createBuffer(),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.iBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),n.STATIC_DRAW),r.push(this)},render:function(){g.push(),j.translate(g.matrix,this.position),n.bindBuffer(n.ARRAY_BUFFER,this.vBuffer),n.vertexAttribPointer(q.aVertexPosition,this.size,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this.cBuffer),n.vertexAttribPointer(q.aVertexColour,4,n.FLOAT,!1,0,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.iBuffer),t(),n.drawElements(this.type,this.indices.length,n.UNSIGNED_SHORT,0),g.pop()}},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1e3/60)}}()})