define("/lib/webgl/core/main",["object","/lib/webgl/core/utils","/lib/webgl/shaders/vertex.gl","/lib/webgl/shaders/fragment.gl"],function(a,b,c){function J(a){if(!!D){var b=a.clientX,c=a.clientY,d=b-E,e=C(d/10,[0,1,0]),f=c-F;e=e.x(C(f/10,[1,0,0])),G=e.x(G),E=b,F=c,y=c}}function I(a){D=!1}function H(a){D=!0,E=a.clientX,F=a.clientY}function C(a,b){var c=a*Math.PI/180;return Matrix.Rotation(c,$V([b[0],b[1],b[2]])).ensure4x4()}function w(){try{h.uniformMatrix4fv(j.uPMatrix,!1,new Float32Array(o.flatten())),h.uniformMatrix4fv(j.uMVMatrix,!1,new Float32Array(n.flatten()))}catch(a){alert(a)}}function v(a,b,c,d){o=makePerspective(a,b,c,d)}function B(a,b){var c=a*Math.PI/180,d=Matrix.Rotation(c,$V([b[0],b[1],b[2]])).ensure4x4();t(d)}function u(a){var b=Matrix.Translation($V([a[0],a[1],a[2]])).ensure4x4();t(b)}function t(a){n=n.x(a)}function s(){n=Matrix.I(4)}function A(){if(x.length==0)throw"Invalid popMatrix!";n=x.pop();return n}function z(a){a?(x.push(a.dup()),n=a.dup()):x.push(n.dup())}var d=a("object"),e=a("/lib/webgl/core/utils"),f=a("/lib/webgl/shaders/vertex.gl"),g=a("/lib/webgl/shaders/fragment.gl"),h,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x;k={},j={},m=[],x=[],p=function(a,b){var c;c=h.createShader(h[a.toUpperCase()+"_SHADER"]),h.shaderSource(c,b),h.compileShader(c);if(!h.getShaderParameter(c,h.COMPILE_STATUS))throw new Error("Could not create shader: "+a+": "+h.getShaderInfoLog(c));return c},q=function(){i=h.createProgram(),h.attachShader(i,p("vertex",f)),h.attachShader(i,p("fragment",g)),h.linkProgram(i);if(!h.getProgramParameter(i,h.LINK_STATUS))throw new Error("Could not initialise shaders");h.useProgram(i),k.aVertexPosition=h.getAttribLocation(i,"aVertexPosition"),h.enableVertexAttribArray(k.aVertexPosition),k.aVertexColour=h.getAttribLocation(i,"aVertexColour"),h.enableVertexAttribArray(k.aVertexColour),j.uPMatrix=h.getUniformLocation(i,"uPMatrix"),j.uMVMatrix=h.getUniformLocation(i,"uMVMatrix")},x=[],r=function(a){try{h=a.getContext("experimental-webgl"),h.viewportWidth=parseFloat(a.style.width,10),h.viewportHeight=parseFloat(a.style.height,10),a.addEventListener("webglcontextcreationerror",function(a){console.error(a.statusMessage)},!1)}catch(b){throw new Error("Could not initialise WebGL, sorry :-(")}};var D=!1,E=null,F=null,G=Matrix.I(4);y=-30,render=function(){var a;h.viewport(0,0,h.viewportWidth,h.viewportHeight),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),v(45,h.viewportWidth/h.viewportHeight,1,1e4),s(),B(0,[1,0,0]),B(-30,[0,1,0]),B(0,[0,0,1]),u([-30,-8,-30]),t(G);for(a=0,l=m.length;a<l;a++)m[a].render()},b.line={__init__:function(){this.type=h.LINES,this.indices=[0,1],this.vBuffer=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,this.vBuffer),h.bufferData(h.ARRAY_BUFFER,new Float32Array(this.vertices),h.STATIC_DRAW),this.cBuffer=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,this.cBuffer),h.bufferData(h.ARRAY_BUFFER,new Float32Array(this.colours),h.STATIC_DRAW),this.iBuffer=h.createBuffer(),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.iBuffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),h.STATIC_DRAW),m.push(this)},render:function(){z(),u(this.position),h.bindBuffer(h.ARRAY_BUFFER,this.vBuffer),h.vertexAttribPointer(k.aVertexPosition,this.size,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,this.cBuffer),h.vertexAttribPointer(k.aVertexColour,4,h.FLOAT,!1,0,0),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.iBuffer),h.lineWidth(1),w(),h.drawElements(this.type,this.indices.length,h.UNSIGNED_SHORT,0),A()}},b.mesh={__init__:function(){this.type=h.TRIANGLES,this.vBuffer=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,this.vBuffer),h.bufferData(h.ARRAY_BUFFER,new Float32Array(this.vertices),h.STATIC_DRAW),this.cBuffer=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,this.cBuffer),h.bufferData(h.ARRAY_BUFFER,new Float32Array(this.colours),h.STATIC_DRAW),this.iBuffer=h.createBuffer(),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.iBuffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),h.STATIC_DRAW),m.push(this)},render:function(){z(),u(this.position),h.bindBuffer(h.ARRAY_BUFFER,this.vBuffer),h.vertexAttribPointer(k.aVertexPosition,this.size,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,this.cBuffer),h.vertexAttribPointer(k.aVertexColour,4,h.FLOAT,!1,0,0),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.iBuffer),w(),h.drawElements(this.type,this.indices.length,h.UNSIGNED_SHORT,0),A()}},b.init=function(a){r(a),q(),h.clearColor(0,0,0,1),h.clearDepth(1),h.enable(h.DEPTH_TEST),h.depthFunc(h.LEQUAL),d.create(b.line,{position:[0,0,0],vertices:[-1e6,0,0,1e6,0,0],colours:[1,0,0,1,1,0,0,1],size:3,items:2}),d.create(b.line,{position:[0,0,0],vertices:[0,-1e6,0,0,1e6,0],colours:[0,0,1,1,0,0,1,1],size:3,items:2}),d.create(b.line,{position:[0,0,0],vertices:[0,0,1e6,0,0,-1e6],colours:[0,1,0,1,0,1,0,1],size:3,items:2}),a.onmousedown=H,document.onmouseup=I,document.onmousemove=J,setInterval(render,1e3/60)}})